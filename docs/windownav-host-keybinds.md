# WINDOWNAV Host Keybind Reference

This document describes the keybinds emitted by the WINDOWNAV keyboard layer. Use
it to configure the window manager, terminal multiplexer, and other host-side
applications to respond to these keybinds.

The keyboard is a ZSA Moonlander running QMK firmware. All keybinds described here
are synthetic key events generated by the keyboard's firmware. The keyboard always
sends left-side modifier keycodes (LCtrl, LAlt, LShift, LSuper), but host
applications should generally match without regard to left/right modifier
distinction unless the WM explicitly differentiates.

## Encoding Scheme

The WINDOWNAV layer manages two axes for directional operations:

- **Scope** (sticky/modal): which coordinate space the operation targets.
  Encoded as modifier bits on the keybind.
- **Action** (transient/held): what kind of operation to perform.
  Encoded as additional modifier bits on the keybind.

### Scope Encoding (modifier bits)

| Scope     | Modifier bits | Typical target       |
|-----------|---------------|----------------------|
| Window    | (none)        | WM (e.g. niri)       |
| Workspace | Alt           | WM                   |
| Pane      | Super         | Terminal multiplexer (e.g. tmux) |
| Monitor   | Alt+Super     | WM                   |

### Action Encoding (additional modifier bits, directional only)

| Action   | Additional modifier | Meaning                             |
|----------|---------------------|-------------------------------------|
| Navigate | (none)              | Move focus                          |
| Move     | Shift               | Move the focused object             |
| Resize   | Ctrl                | Grow/shrink the focused object      |

---

## Directional Operations

Four F-keys encode direction. Scope and action modifiers are added on top.

| Direction | F-key |
|-----------|-------|
| Left      | F13   |
| Up        | F14   |
| Down      | F15   |
| Right     | F16   |

### Full directional keybind matrix

The keybind is: `{scope_mods} + {action_mods} + {F-key}`

| Operation                          | Keybind              |
|------------------------------------|----------------------|
| Navigate window left               | F13                  |
| Navigate window up                 | F14                  |
| Navigate window down               | F15                  |
| Navigate window right              | F16                  |
| Move window left                   | Shift+F13            |
| Move window up                     | Shift+F14            |
| Move window down                   | Shift+F15            |
| Move window right                  | Shift+F16            |
| Resize window left                 | Ctrl+F13             |
| Resize window up                   | Ctrl+F14             |
| Resize window down                 | Ctrl+F15             |
| Resize window right                | Ctrl+F16             |
| Navigate workspace left            | Alt+F13              |
| Navigate workspace up              | Alt+F14              |
| Navigate workspace down            | Alt+F15              |
| Navigate workspace right           | Alt+F16              |
| Move window to workspace left      | Alt+Shift+F13        |
| Move window to workspace up        | Alt+Shift+F14        |
| Move window to workspace down      | Alt+Shift+F15        |
| Move window to workspace right     | Alt+Shift+F16        |
| Resize workspace left              | Alt+Ctrl+F13         |
| Resize workspace up                | Alt+Ctrl+F14         |
| Resize workspace down              | Alt+Ctrl+F15         |
| Resize workspace right             | Alt+Ctrl+F16         |
| Navigate pane left                 | Super+F13            |
| Navigate pane up                   | Super+F14            |
| Navigate pane down                 | Super+F15            |
| Navigate pane right                | Super+F16            |
| Move pane left                     | Super+Shift+F13      |
| Move pane up                       | Super+Shift+F14      |
| Move pane down                     | Super+Shift+F15      |
| Move pane right                    | Super+Shift+F16      |
| Resize pane left                   | Super+Ctrl+F13       |
| Resize pane up                     | Super+Ctrl+F14       |
| Resize pane down                   | Super+Ctrl+F15       |
| Resize pane right                  | Super+Ctrl+F16       |
| Navigate monitor left              | Alt+Super+F13        |
| Navigate monitor up                | Alt+Super+F14        |
| Navigate monitor down              | Alt+Super+F15        |
| Navigate monitor right             | Alt+Super+F16        |
| Move window to monitor left        | Alt+Super+Shift+F13  |
| Move window to monitor up          | Alt+Super+Shift+F14  |
| Move window to monitor down        | Alt+Super+Shift+F15  |
| Move window to monitor right       | Alt+Super+Shift+F16  |

Note: "Resize workspace" and "resize monitor" combinations are sent by the
keyboard but are unlikely to have meaningful WM actions. They can be left unbound
or mapped to no-ops.

---

## Consume/Emit Operations

Consume and emit use separate F-key ranges. Only scope modifiers are applied (no
action modifiers).

| Direction | Consume F-key | Emit F-key |
|-----------|---------------|------------|
| Left      | F17           | F21        |
| Up        | F18           | F22        |
| Down      | F19           | F23        |
| Right     | F20           | F24        |

| Operation                          | Keybind              |
|------------------------------------|----------------------|
| Consume window from left           | F17                  |
| Consume window from up             | F18                  |
| Consume window from down           | F19                  |
| Consume window from right          | F20                  |
| Consume workspace from left        | Alt+F17              |
| Consume workspace from up          | Alt+F18              |
| Consume workspace from down        | Alt+F19              |
| Consume workspace from right       | Alt+F20              |
| Consume pane from left             | Super+F17            |
| Consume pane from up               | Super+F18            |
| Consume pane from down             | Super+F19            |
| Consume pane from right            | Super+F20            |
| Emit window left                   | F21                  |
| Emit window up                     | F22                  |
| Emit window down                   | F23                  |
| Emit window right                  | F24                  |
| Emit workspace left                | Alt+F21              |
| Emit workspace up                  | Alt+F22              |
| Emit workspace down                | Alt+F23              |
| Emit workspace right               | Alt+F24              |
| Emit pane left                     | Super+F21            |
| Emit pane up                       | Super+F22            |
| Emit pane down                     | Super+F23            |
| Emit pane right                    | Super+F24            |

In niri, "consume from right" absorbs the adjacent column's window into the
current column. "Emit right" expels the focused window into a new column to the
right. Equivalent concepts may exist in other tiling WMs.

For tmux (pane scope), consume/emit can be mapped to pane join/break operations.

---

## Tab Operations (Unscoped)

Tab operations are independent of scope. They use Ctrl+Alt as a base modifier to
distinguish from directional operations.

| Operation          | Keybind              |
|--------------------|----------------------|
| Tab navigate left  | Ctrl+Alt+F13         |
| Tab navigate right | Ctrl+Alt+F16         |
| Tab move left      | Ctrl+Alt+Shift+F13   |
| Tab move right     | Ctrl+Alt+Shift+F16   |

Tabs are relevant in applications like browsers, terminal emulators, and tmux.
The host application receiving focus should handle these keybinds.

---

## One-Shot Scoped Actions

These use Ctrl+Shift as a base modifier, plus scope modifiers, plus a letter key.

| Operation          | Letter key |
|--------------------|------------|
| Fullscreen / zoom  | F          |
| Float toggle       | V          |
| Close              | X          |
| Create / add       | A          |

### Full one-shot keybind matrix

| Operation                  | Keybind                   |
|----------------------------|---------------------------|
| Fullscreen window          | Ctrl+Shift+F              |
| Fullscreen workspace       | Ctrl+Shift+Alt+F          |
| Fullscreen/zoom pane       | Ctrl+Shift+Super+F        |
| Fullscreen monitor         | Ctrl+Shift+Alt+Super+F    |
| Float window               | Ctrl+Shift+V              |
| Float workspace            | Ctrl+Shift+Alt+V          |
| Float pane                 | Ctrl+Shift+Super+V        |
| Float monitor              | Ctrl+Shift+Alt+Super+V    |
| Close window               | Ctrl+Shift+X              |
| Close workspace            | Ctrl+Shift+Alt+X          |
| Close pane                 | Ctrl+Shift+Super+X        |
| Close monitor              | Ctrl+Shift+Alt+Super+X    |
| Create window              | Ctrl+Shift+A              |
| Create workspace           | Ctrl+Shift+Alt+A          |
| Create pane                | Ctrl+Shift+Super+A        |
| Create monitor             | Ctrl+Shift+Alt+Super+A    |

Not all scope+action combinations are meaningful. For example, "fullscreen
monitor" or "create monitor" may not have WM equivalents. Leave these unbound.

Typical useful mappings:
- **Fullscreen window**: toggle fullscreen in WM
- **Fullscreen pane**: toggle tmux zoom
- **Float window**: toggle floating/tiling in WM
- **Close window**: close window in WM
- **Close pane**: close pane in tmux
- **Create window**: open a new terminal window
- **Create pane**: split pane in tmux
- **Create workspace**: create a new workspace (if WM supports it)

---

## Absolute Workspace

Switch to or send a window to a specific workspace by number. Uses Ctrl+Alt+Super
as a base modifier with number keys 0-9.

| Operation                      | Keybind                   |
|--------------------------------|---------------------------|
| Switch to workspace 0          | Ctrl+Alt+Super+0          |
| Switch to workspace 1          | Ctrl+Alt+Super+1          |
| Switch to workspace 2          | Ctrl+Alt+Super+2          |
| Switch to workspace 3          | Ctrl+Alt+Super+3          |
| Switch to workspace 4          | Ctrl+Alt+Super+4          |
| Switch to workspace 5          | Ctrl+Alt+Super+5          |
| Switch to workspace 6          | Ctrl+Alt+Super+6          |
| Switch to workspace 7          | Ctrl+Alt+Super+7          |
| Switch to workspace 8          | Ctrl+Alt+Super+8          |
| Switch to workspace 9          | Ctrl+Alt+Super+9          |
| Send window to workspace 0     | Ctrl+Alt+Super+Shift+0    |
| Send window to workspace 1     | Ctrl+Alt+Super+Shift+1    |
| Send window to workspace 2     | Ctrl+Alt+Super+Shift+2    |
| Send window to workspace 3     | Ctrl+Alt+Super+Shift+3    |
| Send window to workspace 4     | Ctrl+Alt+Super+Shift+4    |
| Send window to workspace 5     | Ctrl+Alt+Super+Shift+5    |
| Send window to workspace 6     | Ctrl+Alt+Super+Shift+6    |
| Send window to workspace 7     | Ctrl+Alt+Super+Shift+7    |
| Send window to workspace 8     | Ctrl+Alt+Super+Shift+8    |
| Send window to workspace 9     | Ctrl+Alt+Super+Shift+9    |

WMs that only support workspaces 1-9 should ignore workspace 0.

---

## Launchers

Launchers open an interactive picker or prompt. These are bare keybindings sent
directly by the keyboard (not processed through the WINDOWNAV state machine), so
they can be reconfigured by changing the QMK layer definition.

| Operation     | Keybind        | Mnemonic key |
|---------------|----------------|--------------|
| App launcher  | Alt+P          | **p**rograms |
| SSH prompt    | Alt+Shift+S    | **s**sh      |
| OATH tokens   | Alt+Shift+T    | **t**okens   |

These are accessed via the one-shot launcher prefix (space key in WINDOWNAV layer).

---

## Scratchpads

Scratchpads toggle the visibility of persistent applications (dropdown terminal,
notes, etc.). Like launchers, these are bare keybindings.

| Operation   | Keybind              | Mnemonic key |
|-------------|----------------------|--------------|
| Notes       | Ctrl+Alt+Shift+N     | **n**otes    |
| Terminal    | Ctrl+Alt+Shift+T     | **t**erminal |
| LLM/agent   | Ctrl+Alt+Shift+L     | **l**lm      |
| Calculator  | Ctrl+Alt+Shift+C     | **c**alc     |

These are accessed via the one-shot scratchpad prefix (enter key in WINDOWNAV
layer). The `Ctrl+Alt+Shift` modifier combination is equivalent to the QMK `MEH`
modifier.

---

## Window Switcher

The window switcher emulates native alt-tab (Linux) or cmd-tab (macOS) behavior.
The keyboard registers and holds the actual Alt or Cmd modifier, then sends Tab
keypresses to cycle through windows. No synthetic keybind is needed -- the OS
handles this natively.

This means the OS window switcher must be configured with its default alt-tab
(or cmd-tab) binding for the switcher to work.

---

## Configuration Notes

### Routing keybinds to the right application

Many of these keybinds need to reach different applications depending on scope:

- **Window/Workspace/Monitor scope**: handled by the window manager (niri,
  Aerospace, etc.)
- **Pane scope**: handled by the terminal multiplexer (tmux, zellij, etc.)

The Super modifier identifies pane-scope operations. The WM should be configured
to pass Super+F13-F24 and Super+{other keys} through to the focused application,
or the terminal multiplexer should be configured to intercept them.

### Letter keys in one-shot actions

The letter keys (F, V, X, A) sent for one-shot actions are literal keyboard
scancodes, not affected by the host keyboard layout. On a QWERTY host, these
will be received as F, V, X, A. On a Dvorak host, the WM receives the same
scancodes but may display or match them differently depending on whether it
operates on keysyms or keycodes.

### Linux XKB keysym remapping (important!)

On Linux, the XKB `inet(evdev)` overlay remaps F13-F24 to XF86\* keysyms.
The WM and wev will see these keysyms rather than "F13", "F14", etc.

| HID key | evdev code | XKB keysym      |
|---------|------------|-----------------|
| F13     | 183        | XF86Tools       |
| F14     | 184        | XF86Launch5     |
| F15     | 185        | XF86Launch6     |
| F16     | 186        | XF86Launch7     |
| F17     | 187        | XF86Launch8     |
| F18     | 188        | XF86Launch9     |
| F19     | 189        | XF86Star        |
| F20     | 190        | XF86AudioRewind |
| F21     | 191        | XF86Phone       |
| F22     | 192        | XF86HomePage    |
| F23     | 193        | XF86Close       |
| F24     | 194        | (varies)        |

Note: wev on Wayland displays XKB keycodes (evdev + 8), not raw evdev codes.
If wev shows "key: 191", that is evdev 183 = KEY_F13, not KEY_F21.

WM configurations must use either the XF86\* keysym names or raw keycodes
depending on the WM's binding format. Using "F13" directly will not work unless
custom XKB rules are added to restore F13-F24 keysyms.

### niri-specific notes

niri binds use the format `Mod+Key` and accept XF86 keysym names. Example:

```kdl
binds {
    // Directional: navigate window
    XF86Tools { focus-column-left; }
    XF86Launch5 { focus-workspace-up; }
    XF86Launch6 { focus-workspace-down; }
    XF86Launch7 { focus-column-right; }

    // Directional: move window
    Shift+XF86Tools { move-column-left; }
    Shift+XF86Launch5 { move-column-to-workspace-up; }
    // ... etc.

    // One-shot: fullscreen
    Ctrl+Shift+F { fullscreen-window; }
    // ... etc.
}
```

Alternatively, niri may support binding by raw keycode (evdev code) to avoid
depending on XKB keysym names. Check niri's documentation for the exact syntax.

### tmux-specific notes

tmux cannot bind F13-F24 with modifier combinations directly. Use a tmux plugin
or intermediate keybind relay. Alternatively, configure the terminal emulator to
translate Super+F13-F24 into tmux-compatible escape sequences.

### macOS (Aerospace) notes

Aerospace uses a similar keybind format. The keyboard sends Cmd instead of Alt
for the window switcher on macOS, but the WINDOWNAV layer itself always sends the
same synthetic keybinds regardless of OS. The scope modifier "Alt" corresponds to
the Option key on macOS, and "Super" corresponds to the Command key.
